# -*- coding: utf-8 -*-
"""Tao_QR.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RsKzqSkkER23X4tucNiTw2xA5__5M4WY
"""

import streamlit as st
import pandas as pd

# === Cáº¥u hÃ¬nh ===
SHEET_ID = "1K5EM2wWmKWs5_FSg6SBsUyD8UkGSMAhPnn5ED_VmUPE"
SHEET_NAME = "Sheet1"  # náº¿u sheet báº¡n tÃªn khÃ¡c thÃ¬ sá»­a láº¡i

# === Äá»c dá»¯ liá»‡u tá»« Google Sheets ===
url = f"https://docs.google.com/spreadsheets/d/{SHEET_ID}/gviz/tq?tqx=out:csv&sheet={SHEET_NAME}"
df = pd.read_csv(url)

# === Thiáº¿t láº­p giao diá»‡n ===
st.set_page_config(page_title="Tra cá»©u tÃ i sáº£n", page_icon="ğŸ“¦", layout="centered")

st.title("ğŸ“¦ Tra cá»©u thÃ´ng tin tÃ i sáº£n")

# Láº¥y tham sá»‘ tá»« URL (so_the)
query_params = st.experimental_get_query_params()
so_the = query_params.get("so_the", [""])[0].strip()

# Náº¿u cÃ³ mÃ£ sá»‘ tháº»
if so_the:
    st.subheader(f"MÃ£ sá»‘ tháº»: {so_the}")
    ts = df[df["Sá»‘ tháº»"].astype(str).str.strip().eq(so_the)]

    if not ts.empty:
        record = ts.iloc[0]
        st.markdown(f"""
        **TÃªn tÃ i sáº£n:** {record['TÃŠN TÃ€I Sáº¢N']}
        **ÄÆ¡n vá»‹ tÃ­nh:** {record['ÄÆ¡n vá»‹ tÃ­nh']}
        **NÄƒm sá»­ dá»¥ng:** {int(record['NÄƒm sá»­ dá»¥ng']) if not pd.isna(record['NÄƒm sá»­ dá»¥ng']) else 'N/A'}
        **Sá»‘ lÆ°á»£ng:** {int(record['Sá»‘ lÆ°á»£ng']) if not pd.isna(record['Sá»‘ lÆ°á»£ng']) else 'N/A'}
        **NguyÃªn giÃ¡:** {int(record['NguyÃªn giÃ¡']):,} VNÄ
        **Hao mÃ²n:** {int(record['Hao mÃ²n']):,} VNÄ
        **GiÃ¡ trá»‹ cÃ²n láº¡i:** {int(record['GiÃ¡ trá»‹ cÃ²n láº¡i']):,} VNÄ
        """)
    else:
        st.warning("âš ï¸ KhÃ´ng tÃ¬m tháº¥y tÃ i sáº£n vá»›i mÃ£ sá»‘ tháº» nÃ y.")
else:
    st.info("ğŸ” HÃ£y nháº­p mÃ£ sá»‘ tháº» vÃ o URL, vÃ­ dá»¥: `...?so_the=B02`")