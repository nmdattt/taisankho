# -*- coding: utf-8 -*-
"""Tao_QR.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RsKzqSkkER23X4tucNiTw2xA5__5M4WY
"""

import streamlit as st
import pandas as pd

# === C·∫•u h√¨nh ===
SHEET_ID = "1K5EM2wWmKWs5_FSg6SBsUyD8UkGSMAhPnn5ED_VmUPE"
SHEET_NAME = "Sheet1"  # n·∫øu sheet b·∫°n t√™n kh√°c th√¨ s·ª≠a l·∫°i

# === ƒê·ªçc d·ªØ li·ªáu t·ª´ Google Sheets ===
url = f"https://docs.google.com/spreadsheets/d/{SHEET_ID}/gviz/tq?tqx=out:csv&sheet={SHEET_NAME}"
df = pd.read_csv(url)

# === Thi·∫øt l·∫≠p giao di·ªán ===
st.set_page_config(page_title="Tra c·ª©u t√†i s·∫£n", page_icon="üì¶", layout="centered")

st.title("üì¶ Tra c·ª©u th√¥ng tin t√†i s·∫£n")

# L·∫•y tham s·ªë t·ª´ URL (so_the)
query_params = st.query_params  # kh√¥ng c√≥ ngo·∫∑c
so_the = query_params.get("so_the", [""])[0].strip()

# N·∫øu c√≥ m√£ s·ªë th·∫ª
if so_the:
    st.subheader(f"M√£ s·ªë th·∫ª: {so_the}")
    # Chu·∫©n h√≥a d·ªØ li·ªáu ƒë·ªÉ tr√°nh l·ªói khi c√≥ kho·∫£ng tr·∫Øng ho·∫∑c s·ªë d·∫°ng B02.0
    df["S·ªë th·∫ª"] = df["S·ªë th·∫ª"].astype(str).str.strip().str.upper().str.replace(".0", "", regex=False)
    so_the = so_the.upper().strip()

    # L·ªçc ƒë√∫ng d√≤ng
    ts = df[df["S·ªë th·∫ª"] == so_the]

    if not ts.empty:
        record = ts.iloc[0]
        st.markdown(f"""
        **T√™n t√†i s·∫£n:** {record['T√äN T√ÄI S·∫¢N']}
        **ƒê∆°n v·ªã t√≠nh:** {record['ƒê∆°n v·ªã t√≠nh']}
        **NƒÉm s·ª≠ d·ª•ng:** {int(record['NƒÉm s·ª≠ d·ª•ng']) if not pd.isna(record['NƒÉm s·ª≠ d·ª•ng']) else 'N/A'}
        **S·ªë l∆∞·ª£ng:** {int(record['S·ªë l∆∞·ª£ng']) if not pd.isna(record['S·ªë l∆∞·ª£ng']) else 'N/A'}
        **Nguy√™n gi√°:** {int(record['Nguy√™n gi√°']):,} VNƒê
        **Hao m√≤n:** {int(record['Hao m√≤n']):,} VNƒê
        **Gi√° tr·ªã c√≤n l·∫°i:** {int(record['Gi√° tr·ªã c√≤n l·∫°i']):,} VNƒê
        """)
    else:
        st.warning("‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y t√†i s·∫£n v·ªõi m√£ s·ªë th·∫ª n√†y.")
else:
    st.info("üîé H√£y nh·∫≠p m√£ s·ªë th·∫ª v√†o URL, v√≠ d·ª•: `...?so_the=B02`")
